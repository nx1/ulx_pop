ULX Population Study
====================

This repo contains auxilary files for the paper entitled The effect of Lense-Thirring
on the observed population of ULXs (in prep).


ULXLC
=====
XSPEC model ulxlc: http://www.sternwarte.uni-erlangen.de/~dauser/research/ulxlc/
How to install locally:
    1. Extract to desired location
    2. sudo apt install tcsh
    3. ./compile_ulxlc.csh 
    4. set LOCAL_MODEL_DIRECTORY in /home/.xspec/Xspec.init
    5. add export ULXLC_TABLE_PATH=/home/x1/localmodels/ulxlc to .bashrc
    

DATA FILES
==========
There are several data files that are too large for github.
data/interim/df_a.csv contains the MC simulation results from calculating alive/dead/transient systems from lightcurves.


PIPELINE
========
0. startrack data
Raw datafiles from STARTRACK located in /data/external/data_mdot
The data from these files were combined into the file /data/processed/startrack_concat.csv
From this point forward, the unique system_id of each system is specified by the index in startrack_concat.csv

1. src/data/process_startrack.py
Takes the data from /data/processed/startrack_concat.csv
and calculates various other quantities which are saved in the file
/data/processed/all_systems_df.csv

2. src/ulxlc_runner.py
will sample systems from a df_a.csv (selecting only the systems that are beamed ULXs with opening angles < 45)
and run ulxlc to create a lightcurve with the system's specific parameters and the specified parameters for ULXLC.
The lightcurves are saved with the pattern:

simulation_number-dincl-inclination.txt
and all lightcurve files are saved in data/curves/

The optional argument can be provided to append the simulation information to the .txt file.

3. src/alive_dead_calc.py
Used to process the lightcurve files and classify the system as either alive/dead/transient.
This may be done explicitly, (i.e. calculating the exact amount of time a curve is above or below 1e39 limit)
or (TODO) in a 'quick' manner i.e does the lightcurve span over the 1e39 range and therefore is transient

The results of this processed are saved in the file:
/data/interim/df_a.csv

4. src/df_a_analysis.py
samples from df_a to calculate the effect of the BH_ratio on the alive/dead/transient population

The results from these simulations are saved in:
data/interim/sims_with_metallicity/{Z}/{results.csv}


5. alive_dead_transient_plotter.py
Is used to plot the results from step 4.
 
